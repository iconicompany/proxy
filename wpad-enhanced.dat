function FindProxyForURL(url, host) {

    // QUICK DOMAIN MATCHES (string operations)
    if (
        shExpMatch(host, "(*.|)*.ru") ||
        shExpMatch(host, "(*.|)*.su") ||
        shExpMatch(host, "(*.|)*.xn--p1ai") ||
        shExpMatch(host, "(*.|)*.telegram.org") ||
        shExpMatch(host, "(*.|)*.live.com")
    ) {
        return "DIRECT";
    }

    if (
        shExpMatch(host, "(*.|)intema.ai") ||
        shExpMatch(host, "(*.|)beeai.dev") ||
        shExpMatch(host, "(*.|)authjs.dev") ||
        shExpMatch(host, "(*.|)addy.ie") ||
        shExpMatch(host, "(*.|)gitingest.com") ||
        shExpMatch(host, "(*.|)huggingface.co") ||
        shExpMatch(host, "(*.|)cheatingdaddy.com") ||
        shExpMatch(host, "(*.|)manus.im") ||
        shExpMatch(host, "(*.|)heygen.com") ||
        shExpMatch(host, "(*.|)mermaidchart.com") ||
        shExpMatch(host, "(*.|)claude.com") ||
        shExpMatch(host, "(*.|)notion.*") ||
        shExpMatch(host, "(*.|)fireworks.ai") ||
        shExpMatch(host, "(*.|)litellm.ai") ||
        shExpMatch(host, "(*.|)oxc.rs") ||
        shExpMatch(host, "(*.|)openevidence.com") ||
        shExpMatch(host, "(*.|)oaistatic.com") ||
        shExpMatch(host, "(*.|)chatgpt.com") ||
        shExpMatch(host, "(*.|)openai.com") ||
        shExpMatch(host, "(*.|)openlume.com") ||
        shExpMatch(host, "(*.|)clickup.com") ||
        shExpMatch(host, "(*.|)myip.com") ||
        shExpMatch(host, "(*.|)canva.com") ||
        shExpMatch(host, "(*.|)gstatic.com") ||
        shExpMatch(host, "(*.|)googleadservices.com") ||
        shExpMatch(host, "(*.|)googleapis.com") ||
        shExpMatch(host, "(*.|)google.*") ||
        shExpMatch(host, "(*.|)googlevideo.com") ||
        shExpMatch(host, "(*.|)youtu.be") ||
        shExpMatch(host, "(*.|)youtube.*") ||
        shExpMatch(host, "(*.|)linkedin.com") ||
        shExpMatch(host, "(*.|)x.com") ||
        shExpMatch(host, "(*.|)twimg.com") ||
        shExpMatch(host, "(*.|)microsoft.com")
    ) {
        return "HTTPS proxy.iconicompany.com:3129";
    }

    var ip = dnsResolve(host);
    if (!ip || (ip.indexOf(".") === -1 && ip.indexOf(":" ) === -1)) {
        return "DIRECT";
    }

    // IPv4 DIRECT
    if (
        isInNet(ip, "5.0.0.0", "255.0.0.0") ||
        isInNet(ip, "10.0.0.0", "255.0.0.0") ||
        isInNet(ip, "31.128.0.0", "255.128.0.0") ||
        isInNet(ip, "37.0.0.0", "255.0.0.0") ||
        isInNet(ip, "46.0.0.0", "255.0.0.0") ||
        isInNet(ip, "77.0.0.0", "255.0.0.0") ||
        isInNet(ip, "78.0.0.0", "254.0.0.0") ||
        isInNet(ip, "80.0.0.0", "240.0.0.0") ||
        isInNet(ip, "172.16.0.0", "255.240.0.0") ||
        isInNet(ip, "176.0.0.0", "255.0.0.0") ||
        isInNet(ip, "178.0.0.0", "255.0.0.0") ||
        isInNet(ip, "185.0.0.0", "255.0.0.0") ||
        isInNet(ip, "188.0.0.0", "255.0.0.0") ||
        isInNet(ip, "192.168.0.0", "255.255.0.0") ||
        isInNet(ip, "212.0.0.0", "254.0.0.0") ||
        isInNet(ip, "217.0.0.0", "255.0.0.0")
    ) {
        return "DIRECT";
    }

    // IPv6 helpers
    function expandIPv6(ipv6) {
        if (ipv6.indexOf("::") !== -1) {
            const parts = ipv6.split("::");
            const left = parts[0] ? parts[0].split(":") : [];
            const right = parts[1] ? parts[1].split(":") : [];
            const fill = new Array(8 - left.length - right.length).fill("0");
            ipv6 = [...left, ...fill, ...right].join(":");
        }
        return ipv6;
    }

    function parseIPv6(ipv6) {
        try {
            const full = expandIPv6(ipv6).split(":");
            if (full.length !== 8) return false;
            let hex = "";
            for (let part of full) {
                hex += part.padStart(4, "0");
            }
            return BigInt("0x" + hex);
        } catch (e) { return false; }
    }

    function inIPv6Range(ipv6, low, high) {
        if (ipv6.indexOf(":") === -1) return false;
        const ip = parseIPv6(ipv6);
        const lo = parseIPv6(low);
        const hi = parseIPv6(high);
        if (ip === false || lo === false || hi === false) return false;
        return ip >= lo && ip <= hi;
    }

    // IPv6 DIRECT
    if (
false
    ) {
        return "DIRECT";
    }

    // IPv4 PROXY
    if (
        isInNet(ip, "3.10.17.128", "255.255.255.128") ||
        isInNet(ip, "3.11.53.0", "255.255.255.0") ||
        isInNet(ip, "3.29.40.64", "255.255.255.192") ||
        isInNet(ip, "3.29.40.128", "255.255.255.192") ||
        isInNet(ip, "3.29.40.192", "255.255.255.192") ||
        isInNet(ip, "3.29.57.0", "255.255.255.192") ||
        isInNet(ip, "3.35.130.128", "255.255.255.128") ||
        isInNet(ip, "3.101.158.0", "255.255.254.0") ||
        isInNet(ip, "3.107.43.128", "255.255.255.128") ||
        isInNet(ip, "3.107.44.0", "255.255.255.128") ||
        isInNet(ip, "3.107.44.128", "255.255.255.128") ||
        isInNet(ip, "3.128.93.0", "255.255.255.0") ||
        isInNet(ip, "3.134.215.0", "255.255.255.0") ||
        isInNet(ip, "3.146.232.0", "255.255.252.0") ||
        isInNet(ip, "3.147.164.0", "255.255.252.0") ||
        isInNet(ip, "3.147.244.0", "255.255.252.0") ||
        isInNet(ip, "3.160.0.0", "255.252.0.0") ||
        isInNet(ip, "3.164.0.0", "255.255.192.0") ||
        isInNet(ip, "3.164.64.0", "255.255.192.0") ||
        isInNet(ip, "3.164.128.0", "255.255.128.0") ||
        isInNet(ip, "3.165.0.0", "255.255.0.0") ||
        isInNet(ip, "3.166.0.0", "255.254.0.0") ||
        isInNet(ip, "3.168.0.0", "255.252.0.0") ||
        isInNet(ip, "3.172.0.0", "255.255.192.0") ||
        isInNet(ip, "3.172.64.0", "255.255.192.0") ||
        isInNet(ip, "3.173.0.0", "255.255.128.0") ||
        isInNet(ip, "3.173.128.0", "255.255.192.0") ||
        isInNet(ip, "3.173.192.0", "255.255.192.0") ||
        isInNet(ip, "3.174.0.0", "255.254.0.0") ||
        isInNet(ip, "3.231.2.0", "255.255.255.128") ||
        isInNet(ip, "3.234.232.224", "255.255.255.224") ||
        isInNet(ip, "3.236.48.0", "255.255.254.0") ||
        isInNet(ip, "3.236.169.192", "255.255.255.192") ||
        isInNet(ip, "13.32.0.0", "255.254.0.0") ||
        isInNet(ip, "13.35.0.0", "255.255.0.0") ||
        isInNet(ip, "13.54.63.128", "255.255.255.192") ||
        isInNet(ip, "13.59.250.0", "255.255.255.192") ||
        isInNet(ip, "13.113.196.64", "255.255.255.192") ||
        isInNet(ip, "13.113.203.0", "255.255.255.0") ||
        isInNet(ip, "13.124.199.0", "255.255.255.0") ||
        isInNet(ip, "13.134.24.0", "255.255.254.0") ||
        isInNet(ip, "13.134.94.0", "255.255.254.0") ||
        isInNet(ip, "13.203.133.0", "255.255.255.192") ||
        isInNet(ip, "13.210.67.128", "255.255.255.192") ||
        isInNet(ip, "13.224.0.0", "255.252.0.0") ||
        isInNet(ip, "13.228.69.0", "255.255.255.0") ||
        isInNet(ip, "13.233.177.192", "255.255.255.192") ||
        isInNet(ip, "13.248.155.104", "255.255.255.255") ||
        isInNet(ip, "13.249.0.0", "255.255.0.0") ||
        isInNet(ip, "15.158.0.0", "255.255.0.0") ||
        isInNet(ip, "15.188.184.0", "255.255.255.0") ||
        isInNet(ip, "15.207.13.128", "255.255.255.128") ||
        isInNet(ip, "15.207.213.128", "255.255.255.128") ||
        isInNet(ip, "18.64.0.0", "255.252.0.0") ||
        isInNet(ip, "18.68.0.0", "255.255.0.0") ||
        isInNet(ip, "18.154.0.0", "255.254.0.0") ||
        isInNet(ip, "18.160.0.0", "255.254.0.0") ||
        isInNet(ip, "18.164.0.0", "255.254.0.0") ||
        isInNet(ip, "18.172.0.0", "255.254.0.0") ||
        isInNet(ip, "18.175.65.0", "255.255.255.0") ||
        isInNet(ip, "18.175.66.0", "255.255.255.0") ||
        isInNet(ip, "18.175.67.0", "255.255.255.0") ||
        isInNet(ip, "18.192.142.0", "255.255.254.0") ||
        isInNet(ip, "18.199.68.0", "255.255.252.0") ||
        isInNet(ip, "18.199.72.0", "255.255.252.0") ||
        isInNet(ip, "18.199.76.0", "255.255.252.0") ||
        isInNet(ip, "18.200.212.0", "255.255.254.0") ||
        isInNet(ip, "18.216.170.128", "255.255.255.128") ||
        isInNet(ip, "18.229.220.192", "255.255.255.192") ||
        isInNet(ip, "18.230.229.0", "255.255.255.0") ||
        isInNet(ip, "18.230.230.0", "255.255.255.128") ||
        isInNet(ip, "18.238.0.0", "255.254.0.0") ||
        isInNet(ip, "18.244.0.0", "255.254.0.0") ||
        isInNet(ip, "23.91.0.0", "255.255.224.0") ||
        isInNet(ip, "23.228.220.0", "255.255.255.0") ||
        isInNet(ip, "23.228.221.0", "255.255.255.0") ||
        isInNet(ip, "23.228.222.0", "255.255.255.0") ||
        isInNet(ip, "23.228.223.0", "255.255.255.0") ||
        isInNet(ip, "23.228.224.0", "255.255.255.0") ||
        isInNet(ip, "23.228.225.0", "255.255.255.0") ||
        isInNet(ip, "23.228.226.0", "255.255.255.0") ||
        isInNet(ip, "23.228.227.0", "255.255.255.0") ||
        isInNet(ip, "23.228.237.0", "255.255.255.0") ||
        isInNet(ip, "24.110.32.0", "255.255.224.0") ||
        isInNet(ip, "34.195.252.0", "255.255.255.0") ||
        isInNet(ip, "34.216.51.0", "255.255.255.128") ||
        isInNet(ip, "34.223.12.224", "255.255.255.224") ||
        isInNet(ip, "34.223.80.192", "255.255.255.192") ||
        isInNet(ip, "34.226.14.0", "255.255.255.0") ||
        isInNet(ip, "35.93.168.0", "255.255.254.0") ||
        isInNet(ip, "35.93.170.0", "255.255.254.0") ||
        isInNet(ip, "35.93.172.0", "255.255.254.0") ||
        isInNet(ip, "35.158.136.0", "255.255.255.0") ||
        isInNet(ip, "35.162.63.192", "255.255.255.192") ||
        isInNet(ip, "35.167.191.128", "255.255.255.192") ||
        isInNet(ip, "36.103.232.0", "255.255.255.128") ||
        isInNet(ip, "36.103.232.128", "255.255.255.192") ||
        isInNet(ip, "43.218.56.64", "255.255.255.192") ||
        isInNet(ip, "43.218.56.128", "255.255.255.192") ||
        isInNet(ip, "43.218.56.192", "255.255.255.192") ||
        isInNet(ip, "43.218.71.0", "255.255.255.192") ||
        isInNet(ip, "44.220.194.0", "255.255.254.0") ||
        isInNet(ip, "44.220.196.0", "255.255.254.0") ||
        isInNet(ip, "44.220.198.0", "255.255.254.0") ||
        isInNet(ip, "44.220.200.0", "255.255.254.0") ||
        isInNet(ip, "44.220.202.0", "255.255.254.0") ||
        isInNet(ip, "44.222.66.0", "255.255.255.0") ||
        isInNet(ip, "44.227.178.0", "255.255.255.0") ||
        isInNet(ip, "44.234.90.252", "255.255.255.252") ||
        isInNet(ip, "44.234.108.128", "255.255.255.128") ||
        isInNet(ip, "47.129.82.0", "255.255.255.0") ||
        isInNet(ip, "47.129.83.0", "255.255.255.0") ||
        isInNet(ip, "47.129.84.0", "255.255.255.0") ||
        isInNet(ip, "51.44.234.0", "255.255.254.0") ||
        isInNet(ip, "51.44.236.0", "255.255.254.0") ||
        isInNet(ip, "51.44.238.0", "255.255.254.0") ||
        isInNet(ip, "52.15.127.128", "255.255.255.192") ||
        isInNet(ip, "52.46.0.0", "255.255.192.0") ||
        isInNet(ip, "52.47.139.0", "255.255.255.0") ||
        isInNet(ip, "52.52.191.128", "255.255.255.192") ||
        isInNet(ip, "52.56.127.0", "255.255.255.128") ||
        isInNet(ip, "52.57.254.0", "255.255.255.0") ||
        isInNet(ip, "52.66.194.128", "255.255.255.192") ||
        isInNet(ip, "52.78.247.128", "255.255.255.192") ||
        isInNet(ip, "52.82.128.0", "255.255.224.0") ||
        isInNet(ip, "52.84.0.0", "255.254.0.0") ||
        isInNet(ip, "52.124.128.0", "255.255.128.0") ||
        isInNet(ip, "52.199.127.192", "255.255.255.192") ||
        isInNet(ip, "52.212.248.0", "255.255.255.192") ||
        isInNet(ip, "52.220.191.0", "255.255.255.192") ||
        isInNet(ip, "52.222.128.0", "255.255.128.0") ||
        isInNet(ip, "54.182.0.0", "255.255.0.0") ||
        isInNet(ip, "54.192.0.0", "255.255.0.0") ||
        isInNet(ip, "54.230.0.0", "255.255.128.0") ||
        isInNet(ip, "54.230.128.0", "255.255.192.0") ||
        isInNet(ip, "54.230.200.0", "255.255.248.0") ||
        isInNet(ip, "54.230.208.0", "255.255.240.0") ||
        isInNet(ip, "54.230.224.0", "255.255.224.0") ||
        isInNet(ip, "54.233.255.128", "255.255.255.192") ||
        isInNet(ip, "54.239.128.0", "255.255.192.0") ||
        isInNet(ip, "54.239.192.0", "255.255.224.0") ||
        isInNet(ip, "54.240.128.0", "255.255.192.0") ||
        isInNet(ip, "56.125.46.0", "255.255.255.0") ||
        isInNet(ip, "56.125.47.0", "255.255.255.255") ||
        isInNet(ip, "56.125.48.0", "255.255.255.0") ||
        isInNet(ip, "57.182.253.0", "255.255.255.0") ||
        isInNet(ip, "57.183.42.0", "255.255.255.128") ||
        isInNet(ip, "58.254.138.0", "255.255.255.128") ||
        isInNet(ip, "58.254.138.128", "255.255.255.192") ||
        isInNet(ip, "64.252.64.0", "255.255.192.0") ||
        isInNet(ip, "64.252.128.0", "255.255.192.0") ||
        isInNet(ip, "65.8.0.0", "255.255.0.0") ||
        isInNet(ip, "65.9.0.0", "255.255.128.0") ||
        isInNet(ip, "65.9.128.0", "255.255.192.0") ||
        isInNet(ip, "70.132.0.0", "255.255.192.0") ||
        isInNet(ip, "71.152.0.0", "255.255.128.0") ||
        isInNet(ip, "76.76.21.21", "255.255.255.255") ||
        isInNet(ip, "76.223.126.88", "255.255.255.255") ||
        isInNet(ip, "99.79.169.0", "255.255.255.0") ||
        isInNet(ip, "99.84.0.0", "255.255.0.0") ||
        isInNet(ip, "99.86.0.0", "255.255.0.0") ||
        isInNet(ip, "103.21.244.0", "255.255.252.0") ||
        isInNet(ip, "103.22.200.0", "255.255.252.0") ||
        isInNet(ip, "103.31.4.0", "255.255.252.0") ||
        isInNet(ip, "104.16.0.0", "255.248.0.0") ||
        isInNet(ip, "104.24.0.0", "255.252.0.0") ||
        isInNet(ip, "108.138.0.0", "255.254.0.0") ||
        isInNet(ip, "108.156.0.0", "255.252.0.0") ||
        isInNet(ip, "108.162.192.0", "255.255.192.0") ||
        isInNet(ip, "111.13.171.128", "255.255.255.192") ||
        isInNet(ip, "111.13.171.192", "255.255.255.192") ||
        isInNet(ip, "111.13.185.32", "255.255.255.224") ||
        isInNet(ip, "111.13.185.64", "255.255.255.224") ||
        isInNet(ip, "116.129.226.0", "255.255.255.128") ||
        isInNet(ip, "116.129.226.128", "255.255.255.192") ||
        isInNet(ip, "118.193.97.64", "255.255.255.192") ||
        isInNet(ip, "118.193.97.128", "255.255.255.128") ||
        isInNet(ip, "119.147.182.0", "255.255.255.128") ||
        isInNet(ip, "119.147.182.128", "255.255.255.192") ||
        isInNet(ip, "120.52.12.64", "255.255.255.192") ||
        isInNet(ip, "120.52.22.96", "255.255.255.224") ||
        isInNet(ip, "120.52.39.128", "255.255.255.224") ||
        isInNet(ip, "120.52.153.192", "255.255.255.192") ||
        isInNet(ip, "120.232.236.0", "255.255.255.128") ||
        isInNet(ip, "120.232.236.128", "255.255.255.192") ||
        isInNet(ip, "120.253.240.192", "255.255.255.192") ||
        isInNet(ip, "120.253.241.160", "255.255.255.224") ||
        isInNet(ip, "120.253.245.128", "255.255.255.192") ||
        isInNet(ip, "120.253.245.192", "255.255.255.224") ||
        isInNet(ip, "130.176.0.0", "255.255.128.0") ||
        isInNet(ip, "130.176.128.0", "255.255.192.0") ||
        isInNet(ip, "130.176.192.0", "255.255.224.0") ||
        isInNet(ip, "130.176.224.0", "255.255.240.0") ||
        isInNet(ip, "131.0.72.0", "255.255.252.0") ||
        isInNet(ip, "141.101.64.0", "255.255.192.0") ||
        isInNet(ip, "143.204.0.0", "255.255.0.0") ||
        isInNet(ip, "144.220.0.0", "255.255.0.0") ||
        isInNet(ip, "162.158.0.0", "255.254.0.0") ||
        isInNet(ip, "172.64.0.0", "255.248.0.0") ||
        isInNet(ip, "173.245.48.0", "255.255.240.0") ||
        isInNet(ip, "180.163.57.0", "255.255.255.128") ||
        isInNet(ip, "180.163.57.128", "255.255.255.192") ||
        isInNet(ip, "188.114.96.0", "255.255.240.0") ||
        isInNet(ip, "190.93.240.0", "255.255.240.0") ||
        isInNet(ip, "197.234.240.0", "255.255.252.0") ||
        isInNet(ip, "198.41.128.0", "255.255.128.0") ||
        isInNet(ip, "204.246.164.0", "255.255.252.0") ||
        isInNet(ip, "204.246.168.0", "255.255.252.0") ||
        isInNet(ip, "204.246.172.0", "255.255.255.0") ||
        isInNet(ip, "204.246.173.0", "255.255.255.0") ||
        isInNet(ip, "204.246.174.0", "255.255.254.0") ||
        isInNet(ip, "204.246.176.0", "255.255.240.0") ||
        isInNet(ip, "205.251.202.0", "255.255.254.0") ||
        isInNet(ip, "205.251.204.0", "255.255.254.0") ||
        isInNet(ip, "205.251.206.0", "255.255.254.0") ||
        isInNet(ip, "205.251.208.0", "255.255.240.0") ||
        isInNet(ip, "205.251.249.0", "255.255.255.0") ||
        isInNet(ip, "205.251.250.0", "255.255.254.0") ||
        isInNet(ip, "205.251.252.0", "255.255.254.0") ||
        isInNet(ip, "205.251.254.0", "255.255.255.0") ||
        isInNet(ip, "216.137.32.0", "255.255.224.0")
    ) {
        return "HTTPS proxy.iconicompany.com:3129";
    }

    // IPv6 PROXY
    if (
        inIPv6Range(ip, "2400:7fc0:500::", "2400:7fc0:5ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2400:cb00::", "2400:cb00:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2404:c2c0:500::", "2404:c2c0:5ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2405:8100::", "2405:8100:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2405:b500::", "2405:b500:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2409:8c00:2421:300::", "2409:8c00:2421:3ff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2409:8c00:2421:400::", "2409:8c00:2421:4ff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:ddd::", "2600:9000:ddd:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:eee::", "2600:9000:eee:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:fff::", "2600:9000:fff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:1000::", "2600:9000:1fff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:2000::", "2600:9000:2fff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:3000::", "2600:9000:3fff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:4000::", "2600:9000:4fff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5200::", "2600:9000:52ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5308::", "2600:9000:530f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5310::", "2600:9000:531f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5320::", "2600:9000:533f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5340::", "2600:9000:537f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:5380::", "2600:9000:53ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f000::", "2600:9000:f3ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f400::", "2600:9000:f4ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f500::", "2600:9000:f51f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f520::", "2600:9000:f52f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f534::", "2600:9000:f537:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f538::", "2600:9000:f53f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f540::", "2600:9000:f57f:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f580::", "2600:9000:f5ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f600::", "2600:9000:f7ff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2600:9000:f800::", "2600:9000:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2606:4700::", "2606:4700:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2803:f800::", "2803:f800:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2a06:98c0::", "2a06:98c7:ffff:ffff:ffff:ffff:ffff:ffff") ||
        inIPv6Range(ip, "2c0f:f248::", "2c0f:f248:ffff:ffff:ffff:ffff:ffff:ffff")
    ) {
        return "HTTPS proxy.iconicompany.com:3129";
    }

    return "DIRECT";
}
